{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jstef/Code/deiscord-activity-test-1/vercel/src/components/EquipDetailClient.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { DiscordSDK } from \"@discord/embedded-app-sdk\";\r\nimport { toast, Toaster } from \"sonner\";\r\nimport { AnimatePresence, motion } from \"framer-motion\";\r\n\r\nimport type { InventoryItem, ProfileDoc, SlotKey } from \"@/lib/types\";\r\n\r\nconst CLIENT_ID = process.env.NEXT_PUBLIC_DISCORD_CLIENT_ID || \"1463607375331332223\";\r\n\r\nconst SLOT_ORDER: SlotKey[] = [\r\n  \"head\",\r\n  \"shoulders\",\r\n  \"chest\",\r\n  \"hands\",\r\n  \"legs\",\r\n  \"feet\",\r\n  \"main_hand\",\r\n  \"off_hand\",\r\n];\r\n\r\nconst SLOT_LABEL: Record<SlotKey, string> = {\r\n  head: \"Head\",\r\n  shoulders: \"Shoulders\",\r\n  chest: \"Chest\",\r\n  hands: \"Hands\",\r\n  legs: \"Legs\",\r\n  feet: \"Feet\",\r\n  main_hand: \"Main Hand\",\r\n  off_hand: \"Off-Hand\",\r\n};\r\n\r\ntype Rarity = \"common\" | \"epic\" | \"legendary\";\r\n\r\nconst RARITY_UI: Record<\r\n  Rarity,\r\n  { label: string; className: string; glow: string }\r\n> = {\r\n  common: {\r\n    label: \"Common\",\r\n    className: \"bg-zinc-800/80 text-zinc-100 border-zinc-600/60\",\r\n    glow: \"shadow-[0_0_0_1px_rgba(255,255,255,0.08)]\",\r\n  },\r\n  epic: {\r\n    label: \"Epic\",\r\n    className: \"bg-violet-950/60 text-violet-100 border-violet-400/40\",\r\n    glow: \"shadow-[0_0_16px_rgba(168,85,247,0.35)]\",\r\n  },\r\n  legendary: {\r\n    label: \"Legendary\",\r\n    className: \"bg-amber-950/50 text-amber-100 border-amber-400/40\",\r\n    glow: \"shadow-[0_0_18px_rgba(251,191,36,0.35)]\",\r\n  },\r\n};\r\n\r\nfunction safeHash(str: string) {\r\n  let h = 0;\r\n  for (let i = 0; i < str.length; i += 1) {\r\n    h = (h << 5) - h + str.charCodeAt(i);\r\n    h |= 0;\r\n  }\r\n  return Math.abs(h).toString(16);\r\n}\r\n\r\nfunction isProbablyDiscordActivity() {\r\n  const host = window.location.hostname || \"\";\r\n  if (host.endsWith(\"discordsays.com\")) return true;\r\n  if (window.location.search.includes(\"frame_id\")) return true;\r\n  try {\r\n    const origins = (window as any).location.ancestorOrigins;\r\n    if (origins && origins.length > 0 && String(origins[0]).includes(\"discord\")) return true;\r\n  } catch {\r\n    // ignore\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction computeTotalStats(profile: ProfileDoc | null) {\r\n  const base = profile?.base_stats || {\r\n    strength: 0,\r\n    vitality: 0,\r\n    dexterity: 0,\r\n    intelligence: 0,\r\n    mind: 0,\r\n  };\r\n\r\n  const equipped = profile?.equipped || ({} as any);\r\n  const inv = profile?.inventory || [];\r\n\r\n  const byId = new Map(inv.map((i) => [i.item_id, i] as const));\r\n  const sum = { ...base };\r\n\r\n  Object.values(equipped as Record<string, string | null>).forEach((itemId) => {\r\n    if (!itemId) return;\r\n    const it = byId.get(itemId as string);\r\n    if (!it) return;\r\n    const b = it.stat_bonus || {};\r\n    sum.strength += b.strength || 0;\r\n    sum.vitality += b.vitality || 0;\r\n    sum.dexterity += b.dexterity || 0;\r\n    sum.intelligence += b.intelligence || 0;\r\n    sum.mind += b.mind || 0;\r\n  });\r\n\r\n  return sum;\r\n}\r\n\r\nfunction StatRing({\r\n  label,\r\n  value,\r\n  max = 25,\r\n  accent = \"#00e5ff\",\r\n  testId,\r\n}: {\r\n  label: string;\r\n  value: number;\r\n  max?: number;\r\n  accent?: string;\r\n  testId: string;\r\n}) {\r\n  const pct = Math.max(0, Math.min(1, value / max));\r\n  const r = 18;\r\n  const c = 2 * Math.PI * r;\r\n  const dash = c * pct;\r\n  const gap = c - dash;\r\n\r\n  return (\r\n    <div\r\n      className=\"flex items-center gap-3 rounded-xl border border-white/10 bg-white/[0.03] px-3 py-2\"\r\n      data-testid={testId}\r\n    >\r\n      <div className=\"relative h-12 w-12\">\r\n        <svg viewBox=\"0 0 48 48\" className=\"h-12 w-12\" aria-hidden data-testid={`${testId}-ring`}>\r\n          <circle\r\n            cx=\"24\"\r\n            cy=\"24\"\r\n            r={r}\r\n            fill=\"none\"\r\n            stroke=\"rgba(255,255,255,0.10)\"\r\n            strokeWidth=\"4\"\r\n          />\r\n          <circle\r\n            cx=\"24\"\r\n            cy=\"24\"\r\n            r={r}\r\n            fill=\"none\"\r\n            stroke={accent}\r\n            strokeWidth=\"4\"\r\n            strokeLinecap=\"round\"\r\n            strokeDasharray={`${dash} ${gap}`}\r\n            transform=\"rotate(-90 24 24)\"\r\n            style={{ filter: \"drop-shadow(0 0 10px rgba(0,229,255,0.35))\" }}\r\n          />\r\n        </svg>\r\n        <div className=\"absolute inset-0 grid place-items-center\">\r\n          <div className=\"text-sm font-semibold text-white\" data-testid={`${testId}-value`}>\r\n            {value}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"min-w-0\">\r\n        <div className=\"text-xs tracking-wide text-zinc-300\">{label}</div>\r\n        <div className=\"text-[11px] text-zinc-500\">Total rating</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction DevLogin({ onContinue }: { onContinue: (name: string) => void }) {\r\n  const [name, setName] = useState(\"Pilot\");\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[#07090b] text-white\" data-testid=\"dev-login-screen\">\r\n      <div className=\"mx-auto max-w-xl px-6 py-10\">\r\n        <div className=\"rounded-2xl border border-white/10 bg-white/[0.03] p-6 backdrop-blur\">\r\n          <div className=\"text-2xl font-semibold\" data-testid=\"dev-login-title\">\r\n            Equip Detail (Browser Mode)\r\n          </div>\r\n          <p className=\"mt-2 text-sm text-zinc-300\" data-testid=\"dev-login-subtitle\">\r\n            Discord Activity context not detected. Enter a name to continue in dev mode.\r\n          </p>\r\n\r\n          <div className=\"mt-6 space-y-2\">\r\n            <label className=\"text-xs text-zinc-400\" htmlFor=\"dev-name\">\r\n              Username\r\n            </label>\r\n            <input\r\n              id=\"dev-name\"\r\n              value={name}\r\n              onChange={(e) => setName(e.target.value)}\r\n              className=\"w-full rounded-xl border border-white/10 bg-black/30 px-3 py-2 text-white outline-none focus:border-cyan-300/30\"\r\n              data-testid=\"dev-login-username-input\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"mt-6 flex items-center justify-between\">\r\n            <div className=\"text-xs text-zinc-500\" data-testid=\"dev-login-hint\">\r\n              Tip: deploy to test Discord auth inside Activities.\r\n            </div>\r\n            <button\r\n              onClick={() => onContinue(name)}\r\n              className=\"rounded-full border border-cyan-400/20 bg-cyan-400/15 px-5 py-2 text-sm text-cyan-200 hover:bg-cyan-400/20\"\r\n              data-testid=\"dev-login-continue-button\"\r\n              type=\"button\"\r\n            >\r\n              Continue\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction SlotChip({\r\n  slot,\r\n  equippedItem,\r\n  onClick,\r\n}: {\r\n  slot: SlotKey;\r\n  equippedItem: InventoryItem | null;\r\n  onClick: () => void;\r\n}) {\r\n  const rarity: Rarity = (equippedItem?.rarity as Rarity) || \"common\";\r\n  const ui = RARITY_UI[rarity];\r\n\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      onClick={onClick}\r\n      className={`slot-frame group relative w-full rounded-xl border bg-black/25 px-3 py-2 text-left backdrop-blur ${\r\n        equippedItem ? ui.glow : \"\"\r\n      }`}\r\n      data-testid={`equipment-slot-${slot}-button`}\r\n    >\r\n      <div className=\"flex items-center justify-between gap-2\">\r\n        <div className=\"min-w-0\">\r\n          <div\r\n            className=\"text-[11px] uppercase tracking-[0.22em] text-zinc-400\"\r\n            data-testid={`equipment-slot-${slot}-label`}\r\n          >\r\n            {SLOT_LABEL[slot]}\r\n          </div>\r\n          <div\r\n            className=\"mt-1 truncate text-sm font-medium text-white\"\r\n            data-testid={`equipment-slot-${slot}-value`}\r\n          >\r\n            {equippedItem ? equippedItem.name : \"Empty\"}\r\n          </div>\r\n        </div>\r\n        <div className=\"shrink-0\">\r\n          {equippedItem ? (\r\n            <span\r\n              className={`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] ${ui.className}`}\r\n              data-testid={`equipment-slot-${slot}-rarity`}\r\n            >\r\n              {ui.label}\r\n            </span>\r\n          ) : (\r\n            <span\r\n              className=\"inline-flex items-center rounded-full border border-white/10 bg-white/[0.04] px-2 py-0.5 text-[11px] text-zinc-300\"\r\n              data-testid={`equipment-slot-${slot}-empty-badge`}\r\n            >\r\n              —\r\n            </span>\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div className=\"pointer-events-none absolute inset-0 rounded-xl ring-1 ring-inset ring-cyan-300/0 group-hover:ring-cyan-300/20\" />\r\n    </button>\r\n  );\r\n}\r\n\r\nfunction ItemRow({ item, onEquip }: { item: InventoryItem; onEquip: () => void }) {\r\n  const ui = RARITY_UI[item.rarity as Rarity];\r\n  const bonuses = item.stat_bonus || {};\r\n  const bonusParts = Object.entries(bonuses)\r\n    .filter(([, v]) => (v || 0) !== 0)\r\n    .map(([k, v]) => `${k.replace(\"_\", \" \")}: +${v}`);\r\n\r\n  return (\r\n    <div className=\"rounded-xl border border-white/10 bg-white/[0.03] p-3\" data-testid={`inventory-item-${item.item_id}`}>\r\n      <div className=\"flex items-start justify-between gap-3\">\r\n        <div className=\"min-w-0\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <div\r\n              className=\"truncate text-sm font-semibold text-white\"\r\n              data-testid={`inventory-item-${item.item_id}-name`}\r\n            >\r\n              {item.name}\r\n            </div>\r\n            <span\r\n              className={`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] ${ui.className}`}\r\n              data-testid={`inventory-item-${item.item_id}-rarity`}\r\n            >\r\n              {ui.label}\r\n            </span>\r\n          </div>\r\n          <div className=\"mt-1 text-xs text-zinc-400\" data-testid={`inventory-item-${item.item_id}-bonuses`}>\r\n            {bonusParts.length > 0 ? bonusParts.join(\" • \") : \"No bonuses\"}\r\n          </div>\r\n        </div>\r\n        <button\r\n          type=\"button\"\r\n          onClick={onEquip}\r\n          className=\"rounded-full border border-cyan-400/20 bg-cyan-400/15 px-4 py-2 text-sm text-cyan-200 hover:bg-cyan-400/20\"\r\n          data-testid={`inventory-item-${item.item_id}-equip-button`}\r\n        >\r\n          Equip\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function EquipDetailClient() {\r\n  const [bootStatus, setBootStatus] = useState<\r\n    \"booting\" | \"need-dev-login\" | \"loading\" | \"ready\"\r\n  >(\"booting\");\r\n  const [mode, setMode] = useState<\"discord\" | \"browser\">(\"browser\");\r\n\r\n  const [discordSdk, setDiscordSdk] = useState<DiscordSDK | null>(null);\r\n  const [authUser, setAuthUser] = useState<{ id: string; username: string; avatar: string | null } | null>(null);\r\n  const [teamName, setTeamName] = useState(\"SFC TEAM\");\r\n\r\n  const [profile, setProfile] = useState<ProfileDoc | null>(null);\r\n  const [activeSlot, setActiveSlot] = useState<SlotKey | null>(null);\r\n\r\n  const totalStats = useMemo(() => computeTotalStats(profile), [profile]);\r\n\r\n  const equippedItemsBySlot = useMemo(() => {\r\n    const inv = profile?.inventory || [];\r\n    const byId = new Map(inv.map((i) => [i.item_id, i] as const));\r\n    const equipped = profile?.equipped || ({} as any);\r\n\r\n    const out = {} as Record<SlotKey, InventoryItem | null>;\r\n    SLOT_ORDER.forEach((slot) => {\r\n      const id = equipped[slot];\r\n      out[slot] = id ? byId.get(id) || null : null;\r\n    });\r\n    return out;\r\n  }, [profile]);\r\n\r\n  const itemsForActiveSlot = useMemo(() => {\r\n    if (!activeSlot) return [];\r\n    return (profile?.inventory || []).filter((i) => i.slot === activeSlot);\r\n  }, [profile, activeSlot]);\r\n\r\n  async function syncProfile(user: { id: string; username: string; avatar: string | null }) {\r\n    const upsertRes = await fetch(\"/api/profile/upsert\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({\r\n        discord_user_id: user.id,\r\n        username: user.username,\r\n        avatar: user.avatar,\r\n      }),\r\n    });\r\n\r\n    if (!upsertRes.ok) {\r\n      const error = await upsertRes.json().catch(() => ({ error: \"Unknown error\" }));\r\n      throw new Error(`Profile upsert failed: ${error.error || upsertRes.statusText}`);\r\n    }\r\n\r\n    // Upsert now returns the profile directly, so we can use it\r\n    const doc = (await upsertRes.json()) as ProfileDoc;\r\n    setProfile(doc);\r\n  }\r\n\r\n  async function setupDiscord() {\r\n    const sdk = new DiscordSDK(CLIENT_ID);\r\n    setDiscordSdk(sdk);\r\n    await sdk.ready();\r\n\r\n    const { code } = await sdk.commands.authorize({\r\n      client_id: CLIENT_ID,\r\n      response_type: \"code\",\r\n      state: \"\",\r\n      prompt: \"none\",\r\n      scope: [\"identify\", \"guilds\"],\r\n    });\r\n\r\n    const tokenResp = await fetch(\"/api/discord/token\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ code, redirect_uri: window.location.origin }),\r\n    });\r\n\r\n    if (!tokenResp.ok) {\r\n      throw new Error(\"Token exchange failed\");\r\n    }\r\n\r\n    const tokenJson = await tokenResp.json();\r\n    const accessToken = tokenJson.access_token as string;\r\n\r\n    const auth = await sdk.commands.authenticate({ access_token: accessToken });\r\n    if (!auth?.user) throw new Error(\"Discord authenticate did not return user\");\r\n\r\n    const user = {\r\n      id: auth.user.id,\r\n      username: auth.user.username,\r\n      avatar: auth.user.avatar\r\n        ? `https://cdn.discordapp.com/avatars/${auth.user.id}/${auth.user.avatar}.png?size=128`\r\n        : null,\r\n    };\r\n\r\n    setAuthUser(user);\r\n\r\n    try {\r\n      const channelId = (sdk as any).channelId;\r\n      if (channelId) {\r\n        const ch = await (sdk as any).commands.getChannel({ channel_id: channelId });\r\n        if (ch?.name) setTeamName(ch.name);\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    await syncProfile(user);\r\n  }\r\n\r\n  async function setupBrowserDev(devName: string) {\r\n    const user = {\r\n      id: `dev-${safeHash(devName)}`,\r\n      username: devName,\r\n      avatar: null,\r\n    };\r\n    setAuthUser(user);\r\n    await syncProfile(user);\r\n  }\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n\r\n    async function boot() {\r\n      try {\r\n        const discord = isProbablyDiscordActivity();\r\n        if (discord) {\r\n          setMode(\"discord\");\r\n          setBootStatus(\"loading\");\r\n          await setupDiscord();\r\n          if (!mounted) return;\r\n          setBootStatus(\"ready\");\r\n          return;\r\n        }\r\n\r\n        setMode(\"browser\");\r\n        setBootStatus(\"need-dev-login\");\r\n      } catch (e) {\r\n        console.error(e);\r\n        toast.error(\"Failed to initialize Discord auth\", {\r\n          description:\r\n            \"If testing in browser, use Browser Mode. If in Discord, ensure DISCORD_CLIENT_SECRET is configured in Vercel.\",\r\n        });\r\n        setMode(\"browser\");\r\n        setBootStatus(\"need-dev-login\");\r\n      }\r\n    }\r\n\r\n    boot();\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, []);\r\n\r\n  async function equipItem(slot: SlotKey, itemId: string) {\r\n    if (!authUser) return;\r\n\r\n    const res = await fetch(`/api/profile/${encodeURIComponent(authUser.id)}/equipped`, {\r\n      method: \"PUT\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ slot, item_id: itemId }),\r\n    });\r\n\r\n    if (!res.ok) {\r\n      toast.error(\"Equip failed\");\r\n      return;\r\n    }\r\n\r\n    const doc = (await res.json()) as ProfileDoc;\r\n    setProfile(doc);\r\n    toast.success(\"Equipped\", { description: `Updated ${SLOT_LABEL[slot]}.` });\r\n  }\r\n\r\n  async function unequipAll() {\r\n    if (!authUser) return;\r\n\r\n    const res = await fetch(`/api/profile/${encodeURIComponent(authUser.id)}/unequip-all`, {\r\n      method: \"PUT\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({}),\r\n    });\r\n\r\n    const doc = (await res.json()) as ProfileDoc;\r\n    setProfile(doc);\r\n    toast(\"Unequipped\", { description: \"All slots cleared.\" });\r\n  }\r\n\r\n  async function autoEquip() {\r\n    if (!authUser) return;\r\n\r\n    const res = await fetch(`/api/profile/${encodeURIComponent(authUser.id)}/auto-equip`, {\r\n      method: \"PUT\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({}),\r\n    });\r\n\r\n    const doc = (await res.json()) as ProfileDoc;\r\n    setProfile(doc);\r\n    toast(\"Auto-equipped\", { description: \"Best items equipped by rarity.\" });\r\n  }\r\n\r\n  async function shareLoadout() {\r\n    if (mode !== \"discord\" || !discordSdk) {\r\n      toast(\"Share Loadout\", {\r\n        description: \"In Browser Mode this is a preview. In Discord it will set activity.\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const slots = Object.values(profile?.equipped || {}).filter(Boolean).length;\r\n      await (discordSdk as any).commands.setActivity({\r\n        activity: {\r\n          state: `Loadout: ${slots} slots`,\r\n          details: \"Equip Detail\",\r\n        },\r\n      });\r\n      toast.success(\"Shared\", { description: \"Activity updated.\" });\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error(\"Share failed\", {\r\n        description:\r\n          \"Discord setActivity may require additional permissions/config. This is best-effort in MVP.\",\r\n      });\r\n    }\r\n  }\r\n\r\n  if (bootStatus === \"need-dev-login\") {\r\n    return (\r\n      <DevLogin\r\n        onContinue={async (name) => {\r\n          setBootStatus(\"loading\");\r\n          await setupBrowserDev(name);\r\n          setBootStatus(\"ready\");\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n  if (bootStatus !== \"ready\") {\r\n    return (\r\n      <div className=\"min-h-screen bg-[#07090b] text-white\" data-testid=\"loading-screen\">\r\n        <div className=\"mx-auto max-w-4xl px-6 py-10\">\r\n          <div className=\"rounded-2xl border border-white/10 bg-white/[0.03] p-6 backdrop-blur\">\r\n            <div className=\"text-base text-zinc-200\" data-testid=\"loading-text\">\r\n              Loading…\r\n            </div>\r\n            <div className=\"mt-2 text-sm text-zinc-500\" data-testid=\"loading-subtext\">\r\n              Initializing Discord Activity session.\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const userAvatar = authUser?.avatar;\r\n\r\n  return (\r\n    <div className=\"min-h-screen equip-bg text-white\" data-testid=\"equip-detail-root\">\r\n      <Toaster richColors />\r\n\r\n      <div className=\"px-5 pt-5 pb-20\">\r\n        <div className=\"mx-auto w-full max-w-7xl\">\r\n          {/* Top Bar */}\r\n          <div className=\"flex flex-wrap items-center justify-between gap-3 rounded-2xl border border-white/10 bg-white/[0.03] px-4 py-3 backdrop-blur\" data-testid=\"top-bar\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"h-10 w-10 rounded-xl bg-cyan-400/10 ring-1 ring-inset ring-cyan-300/20\" />\r\n              <div>\r\n                <div className=\"text-xs uppercase tracking-[0.28em] text-zinc-400\" data-testid=\"top-bar-team-label\">\r\n                  Team Name\r\n                </div>\r\n                <div className=\"text-lg font-semibold text-white\" data-testid=\"top-bar-team-name\">\r\n                  {teamName}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-3\">\r\n              <a\r\n                href=\"/terms\"\r\n                className=\"rounded-full border border-white/10 bg-white/[0.02] px-4 py-2 text-sm hover:bg-white/[0.05]\"\r\n                data-testid=\"top-bar-terms-link\"\r\n              >\r\n                Terms\r\n              </a>\r\n              <a\r\n                href=\"/privacy\"\r\n                className=\"rounded-full border border-white/10 bg-white/[0.02] px-4 py-2 text-sm hover:bg-white/[0.05]\"\r\n                data-testid=\"top-bar-privacy-link\"\r\n              >\r\n                Privacy\r\n              </a>\r\n\r\n              <div className=\"flex items-center gap-3 rounded-full border border-white/10 bg-white/[0.02] px-3 py-1.5\" data-testid=\"user-profile-pill\">\r\n                <div className=\"h-8 w-8 overflow-hidden rounded-full bg-white/10\" data-testid=\"user-profile-avatar\">\r\n                  {userAvatar ? (\r\n                    <img src={userAvatar} alt=\"User avatar\" className=\"h-full w-full object-cover\" data-testid=\"user-profile-avatar-img\" />\r\n                  ) : (\r\n                    <div className=\"h-full w-full bg-gradient-to-br from-cyan-400/20 to-fuchsia-400/10\" data-testid=\"user-profile-avatar-fallback\" />\r\n                  )}\r\n                </div>\r\n                <div className=\"min-w-0\">\r\n                  <div className=\"text-xs uppercase tracking-[0.24em] text-zinc-400\" data-testid=\"user-profile-mode\">\r\n                    {mode === \"discord\" ? \"Discord\" : \"Browser\"}\r\n                  </div>\r\n                  <div className=\"truncate text-sm font-semibold\" data-testid=\"user-profile-username\">\r\n                    {authUser?.username}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-6 grid grid-cols-1 gap-6 lg:grid-cols-[320px_1fr]\">\r\n            {/* Sidebar */}\r\n            <div className=\"rounded-2xl border border-white/10 bg-white/[0.03] p-4 backdrop-blur\" data-testid=\"stats-sidebar\">\r\n              <div className=\"text-xs uppercase tracking-[0.28em] text-zinc-400\" data-testid=\"stats-title\">\r\n                Combat Stats\r\n              </div>\r\n              <div className=\"mt-4 space-y-3\" data-testid=\"stats-list\">\r\n                <StatRing label=\"Strength\" value={totalStats.strength} testId=\"stat-strength\" />\r\n                <StatRing label=\"Vitality\" value={totalStats.vitality} testId=\"stat-vitality\" />\r\n                <StatRing label=\"Dexterity\" value={totalStats.dexterity} testId=\"stat-dexterity\" />\r\n                <StatRing label=\"Intelligence\" value={totalStats.intelligence} testId=\"stat-intelligence\" />\r\n                <StatRing label=\"Mind\" value={totalStats.mind} testId=\"stat-mind\" />\r\n              </div>\r\n\r\n              <div className=\"my-5 h-px bg-white/10\" />\r\n\r\n              <div className=\"text-xs uppercase tracking-[0.28em] text-zinc-400\" data-testid=\"sidebar-hint-title\">\r\n                Quick Tips\r\n              </div>\r\n              <ul className=\"mt-3 space-y-2 text-sm text-zinc-300\" data-testid=\"sidebar-hint-list\">\r\n                <li>Click a slot to see items for that slot.</li>\r\n                <li>Legendary items glow brighter.</li>\r\n                <li>Use Auto‑Equip to fill everything fast.</li>\r\n              </ul>\r\n            </div>\r\n\r\n            {/* Main */}\r\n            <div className=\"relative rounded-2xl border border-white/10 bg-white/[0.02] p-4 backdrop-blur\" data-testid=\"equip-main\">\r\n              <div className=\"equip-grid\" aria-hidden />\r\n\r\n              <div className=\"grid grid-cols-1 gap-6 xl:grid-cols-[1fr_440px]\">\r\n                <div className=\"relative min-h-[520px]\">\r\n                  <div\r\n                    className=\"absolute left-1/2 top-1/2 h-[380px] w-[380px] -translate-x-1/2 -translate-y-1/2 rounded-full border border-cyan-300/15 bg-black/20\"\r\n                    style={{ boxShadow: \"0 0 60px rgba(0,229,255,0.12)\" }}\r\n                    data-testid=\"character-ring\"\r\n                  />\r\n\r\n                  <div className=\"absolute left-1/2 top-1/2 h-[270px] w-[220px] -translate-x-1/2 -translate-y-1/2\" data-testid=\"character-preview\">\r\n                    <div className=\"h-full w-full rounded-2xl border border-white/10 bg-black/20 p-3\">\r\n                      <svg viewBox=\"0 0 240 300\" className=\"h-full w-full\" data-testid=\"character-placeholder-svg\">\r\n                        <defs>\r\n                          <linearGradient id=\"cy\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"1\">\r\n                            <stop offset=\"0\" stopColor=\"rgba(0,229,255,0.55)\" />\r\n                            <stop offset=\"1\" stopColor=\"rgba(168,85,247,0.20)\" />\r\n                          </linearGradient>\r\n                        </defs>\r\n                        <path d=\"M120 18c24 0 42 18 42 42s-18 42-42 42-42-18-42-42 18-42 42-42Z\" fill=\"url(#cy)\" opacity=\"0.9\" />\r\n                        <path\r\n                          d=\"M70 130c10-10 22-18 50-18s40 8 50 18l18 32-18 20v78l-50 22-50-22v-78l-18-20 18-32Z\"\r\n                          fill=\"rgba(255,255,255,0.06)\"\r\n                          stroke=\"rgba(0,229,255,0.28)\"\r\n                          strokeWidth=\"2\"\r\n                        />\r\n                        <path d=\"M55 165h130\" stroke=\"rgba(255,255,255,0.10)\" strokeWidth=\"2\" />\r\n                        <path d=\"M80 260l40 18 40-18\" stroke=\"rgba(0,229,255,0.28)\" strokeWidth=\"2\" />\r\n                      </svg>\r\n                      <div className=\"mt-2 text-center text-xs uppercase tracking-[0.28em] text-zinc-400\" data-testid=\"character-caption\">\r\n                        Character Preview\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"absolute inset-0\" data-testid=\"slots-layout\">\r\n                    <div className=\"slot-pos slot-head\">\r\n                      <SlotChip slot=\"head\" equippedItem={equippedItemsBySlot.head} onClick={() => setActiveSlot(\"head\")} />\r\n                    </div>\r\n                    <div className=\"slot-pos slot-shoulders\">\r\n                      <SlotChip slot=\"shoulders\" equippedItem={equippedItemsBySlot.shoulders} onClick={() => setActiveSlot(\"shoulders\")} />\r\n                    </div>\r\n                    <div className=\"slot-pos slot-chest\">\r\n                      <SlotChip slot=\"chest\" equippedItem={equippedItemsBySlot.chest} onClick={() => setActiveSlot(\"chest\")} />\r\n                    </div>\r\n                    <div className=\"slot-pos slot-hands\">\r\n                      <SlotChip slot=\"hands\" equippedItem={equippedItemsBySlot.hands} onClick={() => setActiveSlot(\"hands\")} />\r\n                    </div>\r\n                    <div className=\"slot-pos slot-mainhand\">\r\n                      <SlotChip slot=\"main_hand\" equippedItem={equippedItemsBySlot.main_hand} onClick={() => setActiveSlot(\"main_hand\")} />\r\n                    </div>\r\n                    <div className=\"slot-pos slot-legs\">\r\n                      <SlotChip slot=\"legs\" equippedItem={equippedItemsBySlot.legs} onClick={() => setActiveSlot(\"legs\")} />\r\n                    </div>\r\n                    <div className=\"slot-pos slot-feet\">\r\n                      <SlotChip slot=\"feet\" equippedItem={equippedItemsBySlot.feet} onClick={() => setActiveSlot(\"feet\")} />\r\n                    </div>\r\n                    <div className=\"slot-pos slot-offhand\">\r\n                      <SlotChip slot=\"off_hand\" equippedItem={equippedItemsBySlot.off_hand} onClick={() => setActiveSlot(\"off_hand\")} />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Side panel */}\r\n                <div className=\"rounded-2xl border border-white/10 bg-white/[0.03] p-4\" data-testid=\"side-panel\">\r\n                  <div className=\"flex items-center justify-between gap-3\">\r\n                    <div>\r\n                      <div className=\"text-xs uppercase tracking-[0.28em] text-zinc-400\" data-testid=\"side-panel-label\">\r\n                        {activeSlot ? \"Slot\" : \"Inventory\"}\r\n                      </div>\r\n                      <div className=\"mt-1 text-sm text-zinc-200\" data-testid=\"side-panel-title\">\r\n                        {activeSlot ? SLOT_LABEL[activeSlot] : \"Select a slot to filter items.\"}\r\n                      </div>\r\n                    </div>\r\n\r\n                    {activeSlot ? (\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"rounded-full border border-white/10 bg-white/[0.02] px-4 py-2 text-sm hover:bg-white/[0.05]\"\r\n                        onClick={() => setActiveSlot(null)}\r\n                        data-testid=\"side-panel-close-button\"\r\n                      >\r\n                        Close\r\n                      </button>\r\n                    ) : (\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"rounded-full border border-white/10 bg-white/[0.02] px-4 py-2 text-sm hover:bg-white/[0.05]\"\r\n                        onClick={() => setActiveSlot(\"head\")}\r\n                        data-testid=\"inventory-open-default-slot-button\"\r\n                      >\r\n                        Browse\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n\r\n                  <div className=\"my-4 h-px bg-white/10\" />\r\n\r\n                  <div className=\"h-[420px] overflow-auto pr-3\" data-testid=\"side-panel-scroll\">\r\n                    <div className=\"space-y-3\" data-testid=\"side-panel-items\">\r\n                      {(activeSlot ? itemsForActiveSlot : (profile?.inventory || []).slice(0, 10)).map((it) => (\r\n                        <ItemRow key={it.item_id} item={it} onEquip={() => equipItem(it.slot, it.item_id)} />\r\n                      ))}\r\n\r\n                      {(profile?.inventory || []).length === 0 ? (\r\n                        <div className=\"rounded-xl border border-white/10 bg-white/[0.03] p-4 text-sm text-zinc-300\" data-testid=\"inventory-empty\">\r\n                          No items yet.\r\n                        </div>\r\n                      ) : null}\r\n\r\n                      {activeSlot && itemsForActiveSlot.length === 0 ? (\r\n                        <div className=\"rounded-xl border border-white/10 bg-white/[0.03] p-4 text-sm text-zinc-300\" data-testid=\"side-panel-empty\">\r\n                          No items for this slot.\r\n                        </div>\r\n                      ) : null}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Bottom actions */}\r\n              <div className=\"mt-6 flex flex-wrap items-center justify-between gap-3\" data-testid=\"bottom-action-bar\">\r\n                <div className=\"flex flex-wrap items-center gap-3\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={autoEquip}\r\n                    className=\"rounded-full border border-cyan-400/20 bg-cyan-400/15 px-5 py-2 text-sm text-cyan-200 hover:bg-cyan-400/20\"\r\n                    data-testid=\"auto-equip-button\"\r\n                  >\r\n                    Auto‑Equip\r\n                  </button>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={unequipAll}\r\n                    className=\"rounded-full border border-white/10 bg-white/[0.02] px-5 py-2 text-sm hover:bg-white/[0.05]\"\r\n                    data-testid=\"unequip-all-button\"\r\n                  >\r\n                    Unequip All\r\n                  </button>\r\n                </div>\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={shareLoadout}\r\n                  className=\"rounded-full border border-fuchsia-400/20 bg-fuchsia-500/15 px-5 py-2 text-sm text-fuchsia-200 hover:bg-fuchsia-500/20\"\r\n                  data-testid=\"share-loadout-button\"\r\n                >\r\n                  Share Loadout\r\n                </button>\r\n              </div>\r\n\r\n              <AnimatePresence>\r\n                {activeSlot ? (\r\n                  <motion.div\r\n                    initial={{ opacity: 0 }}\r\n                    animate={{ opacity: 1 }}\r\n                    exit={{ opacity: 0 }}\r\n                    transition={{ duration: 0.15 }}\r\n                    className=\"pointer-events-none absolute inset-0\"\r\n                    data-testid=\"slot-panel-placeholder\"\r\n                  />\r\n                ) : null}\r\n              </AnimatePresence>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}